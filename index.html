<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Which Era Are You?</title>
  <style>
    :root {
      --bg1: #f8d7f8;
      --bg2: #d7f8f3;
      --card: #ffffff;
      --shadow-sm: 0 2px 6px rgba(0,0,0,0.1);
      --shadow-md: 0 4px 12px rgba(0,0,0,0.2);
      --radius: 12px;
      --radius-btn: 10px;
      --disabled: #dcdcdc;
    }
    * { box-sizing: border-box; }
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(to right, var(--bg1), var(--bg2));
      margin: 0;
      padding: 0 16px 40px;
      text-align: center;
      min-height: 100vh;
    }
    .topbar {
      position: sticky;
      top: 0;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      padding: 12px 0 0;
      z-index: 5;
      text-align: left;
    }
    #backBtn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: var(--card);
      border: 1px solid rgba(0,0,0,0.08);
      border-radius: 999px;
      padding: 10px 14px;
      box-shadow: var(--shadow-sm);
      cursor: pointer;
      font-size: 14px;
      transition: transform 0.05s ease, background 0.3s ease, opacity 0.2s ease;
      user-select: none;
    }
    #backBtn:hover { background: #f0e0f7; }
    #backBtn:active { transform: translateY(1px); }
    #backBtn[disabled] {
      opacity: 0.5;
      cursor: default;
      background: var(--disabled);
      box-shadow: none;
    }
    #backBtn svg { width: 18px; height: 18px; transform: rotate(180deg); }
    h1 { margin: 10px 0 18px; font-size: 2em; }
    #quiz { max-width: 640px; margin: 0 auto; padding: 10px; }
    .question h3 { font-size: 1.3em; margin-bottom: 15px; }
    .answers button {
      display: block;
      width: 100%;
      margin: 8px 0;
      padding: 12px;
      border: none;
      border-radius: var(--radius-btn);
      background: var(--card);
      font-size: 1em;
      box-shadow: var(--shadow-sm);
      transition: background 0.3s;
    }
    .answers button:hover { background: #f0e0f7; cursor: pointer; }
    .answers button {
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }
    .answers button:focus { outline: none; }
    .answers button:focus-visible { outline: 2px solid rgba(100,120,255,0.6); }

    #result {
      display: none;
      margin: 24px auto 0;
      padding: 20px;
      border-radius: var(--radius);
      background: var(--card);
      box-shadow: var(--shadow-md);
      max-width: 640px;
    }
    .progress {
      font-size: 12px;
      margin-left: 8px;
      opacity: 0.8;
    }
  </style>
</head>
<body>
  <div class="topbar">
    <button id="backBtn" aria-label="Go back to the previous question">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
        <path d="M10.828 11.293 15.121 7l1.415 1.414-3.293 3.293 3.293 3.293-1.415 1.414-4.293-4.293a1 1 0 0 1 0-1.414Z"/>
      </svg>
      Back
    </button>
    <div class="progress" id="progress" aria-live="polite"></div>
  </div>

  <h1>Which Era Are You?</h1>
  <div id="quiz" role="region" aria-live="polite"></div>
  <div id="result" role="region" aria-live="polite"></div>

  <script>
    const albums = [
      "Taylor Swift (Debut)", "Fearless", "Speak Now", "Red",
      "1989", "Reputation", "Lover", "Folklore",
      "Evermore", "Midnights", "The Tortured Poets Department",
      "The Life of a Showgirl"
    ];

    const albumEmojis = {
      "Taylor Swift (Debut)": "ðŸŒ¾",
      "Fearless": "âœ¨",
      "Speak Now": "ðŸ’œ",
      "Red": "â¤ï¸",
      "1989": "ðŸ©µ",
      "Reputation": "ðŸ",
      "Lover": "ðŸ’–",
      "Folklore": "ðŸŒ²",
      "Evermore": "ðŸ‚",
      "Midnights": "ðŸŒ™",
      "The Tortured Poets Department": "ðŸ–‹ï¸",
      "The Life of a Showgirl": "â¤ï¸â€ðŸ”¥"
    };

    function mapAlbumKey(album){
      if (album === "Debut") return "Taylor Swift (Debut)";
      if (album === "TTPD") return "The Tortured Poets Department";
      if (album === "Showgirl") return "The Life of a Showgirl";
      return album;
    }

    const questions = [
      {
        question: "Whatâ€™s your current vibe in life?",
        answers: [
          { text: "Calmly rebuilding myself", scores: {"1989":2, "Debut":1} },
          { text: "Romantic and hopeful", scores: {"Lover":2, "Fearless":1, "Showgirl":1} },
          { text: "Quiet reflection", scores: {"Red":2, "Folklore":1} },
          { text: "Energetic and ambitious", scores: {"Speak Now":2, "Midnights":1, "Showgirl":1} },
          { text: "Melancholy but inspired", scores: {"TTPD":2, "Evermore":1} }
        ]
      },
      {
        question: "Whatâ€™s your favorite time of day?",
        answers: [
          { text: "Vibing early morning", scores: {"Debut":2, "Fearless":1} },
          { text: "Late night in silence", scores: {"Red":2, "Midnights":1} },
          { text: "Golden sunset", scores: {"Lover":2, "Evermore":1} },
          { text: "Energetic night", scores: {"Showgirl":2, "Reputation":1} },
          { text: "Rainy afternoon", scores: {"Folklore":2, "TTPD":1} }
        ]
      },
      {
        question: "Whatâ€™s your ideal weekend activity?",
        answers: [
          { text: "Writing or journaling", scores: {"Fearless":2, "Folklore":1} },
          { text: "Dancing with friends", scores: {"1989":2, "Speak Now":1, "Showgirl":1} },
          { text: "Baking or cozy indoors", scores: {"Evermore":2, "Lover":1} },
          { text: "Red carpet + movie night", scores: {"Showgirl":2, "1989":1} },
          { text: "Reflecting alone", scores: {"TTPD":2, "Midnights":1} }
        ]
      },
      {
        question: "Whatâ€™s your reaction to betrayal?",
        answers: [
          { text: "Revenge, loudly", scores: {"Reputation":2, "Midnights":1} },
          { text: "Sadness then writing", scores: {"Evermore":2, "Red":1} },
          { text: "Silent processing", scores: {"Folklore":2, "Debut":1} },
          { text: "Cutting ties immediately", scores: {"1989":2, "Speak Now":1} },
          { text: "Turn pain into performance", scores: {"Showgirl":2, "TTPD":1} }
        ]
      },
      {
        question: "What kind of love story are you into?",
        answers: [
          { text: "Star-crossed and tragic", scores: {"Folklore":2, "Evermore":1} },
          { text: "Friends-to-lovers", scores: {"Fearless":2, "Lover":1} },
          { text: "Whirlwind romance", scores: {"1989":2, "Speak Now":1, "Showgirl":1} },
          { text: "Healing and steady", scores: {"Debut":2, "Red":1} },
          { text: "Messy but poetic", scores: {"TTPD":2, "Reputation":1} }
        ]
      },
      {
        question: "Choose a setting for your music video:",
        answers: [
          { text: "A rooftop at night", scores: {"1989":2, "Midnights":1} },
          { text: "Forest at dusk", scores: {"Folklore":2, "Evermore":1} },
          { text: "Neon-lit city", scores: {"Reputation":2, "Speak Now":1, "Showgirl":2} },
          { text: "Vintage diner", scores: {"Debut":2, "Fearless":1} },
          { text: "Candlelit bedroom", scores: {"Lover":2, "TTPD":1} }
        ]
      },
      {
        question: "Which word speaks to you most right now?",
        answers: [
          { text: "Chaos", scores: {"Midnights":2, "Reputation":1} },
          { text: "Growth", scores: {"Speak Now":2, "Fearless":1} },
          { text: "Softness", scores: {"Lover":2, "Evermore":1} },
          { text: "Truth", scores: {"Folklore":2, "Red":1} },
          { text: "Showtime", scores: {"Showgirl":2, "1989":1} }
        ]
      },
      {
        question: "What makes you feel seen?",
        answers: [
          { text: "Being listened to", scores: {"Red":2, "Folklore":1} },
          { text: "Recognition of talent", scores: {"Fearless":2, "Speak Now":1, "Showgirl":1} },
          { text: "Being accepted fully", scores: {"Lover":2, "Evermore":1} },
          { text: "Being trusted deeply", scores: {"Reputation":2, "Debut":1} },
          { text: "Sharing the spotlight", scores: {"Showgirl":2, "Midnights":1} }
        ]
      },
      {
        question: "Pick a Taylor lyric (based on vibe):",
        answers: [
          { text: "Iâ€™m a nightmare dressed like a daydream", scores: {"Reputation":2, "Midnights":1} },
          { text: "I remember it all too well", scores: {"Red":2, "Folklore":1} },
          { text: "Darling, youâ€™re the best thing", scores: {"Speak Now":2, "Fearless":1} },
          { text: "Lights up, curtain call", scores: {"Showgirl":2, "1989":1} },
          { text: "Itâ€™s me, hi, Iâ€™m the problem, itâ€™s me", scores: {"Midnights":2, "Lover":1} }
        ]
      },
      {
        question: "Choose your outfit:",
        answers: [
          { text: "Flowy dress and boots", scores: {"Debut":2, "Fearless":1} },
          { text: "Sparkly party dress", scores: {"1989":2, "Speak Now":1, "Showgirl":2} },
          { text: "Black leather jacket", scores: {"Reputation":2, "Midnights":1} },
          { text: "Soft pastels", scores: {"Lover":2, "Evermore":1} },
          { text: "Vintage oversized shirt", scores: {"Folklore":2, "TTPD":1} }
        ]
      },
      {
        question: "Which drink do you vibe with most?",
        answers: [
          { text: "Warm tea", scores: {"Folklore":2, "Evermore":1} },
          { text: "Wine", scores: {"1989":2, "Lover":1} },
          { text: "Black coffee", scores: {"Reputation":2, "TTPD":1} },
          { text: "Homemade lemonade", scores: {"Debut":2, "Fearless":1} },
          { text: "Cocktail", scores: {"Showgirl":2, "Midnights":1} }
        ]
      },
      {
        question: "Which scenery feels like home?",
        answers: [
          { text: "Golden fields", scores: {"Debut":2, "Fearless":1} },
          { text: "City skyline", scores: {"1989":2, "Reputation":1, "Showgirl":1} },
          { text: "Forest trail", scores: {"Folklore":2, "Evermore":1} },
          { text: "Bedroom window at night", scores: {"Midnights":2, "TTPD":1} },
          { text: "Sunset over the ocean", scores: {"Red":2, "Lover":1} }
        ]
      },
      {
        question: "Pick a creative outlet:",
        answers: [
          { text: "Writing", scores: {"TTPD":2, "Folklore":1} },
          { text: "Singing", scores: {"Speak Now":2, "Fearless":1} },
          { text: "Dancing", scores: {"1989":2, "Lover":1, "Showgirl":2} },
          { text: "Painting or crafting", scores: {"Evermore":2, "Debut":1} },
          { text: "Journaling", scores: {"Midnights":2, "Red":1} }
        ]
      }
    ];

    let currentQ = 0;
    let scores = {};
    const answerHistory = []; // store chosen answer index per question
    const quizEl = document.getElementById("quiz");
    const resultEl = document.getElementById("result");
    const backBtn = document.getElementById("backBtn");
    const progressEl = document.getElementById("progress");

    albums.forEach(a => scores[a] = 0);

    function updateProgress(){
      progressEl.textContent = `Question ${Math.min(currentQ+1, questions.length)} of ${questions.length}`;
      // Disable BACK on first question
      if (currentQ === 0) backBtn.setAttribute("disabled", "true");
      else backBtn.removeAttribute("disabled");
    }

    function renderQuestion() {
      const q = questions[currentQ];
      quizEl.innerHTML = `
        <div class="question">
          <h3>${q.question}</h3>
          <div class="answers">
            ${q.answers.map((a,i) => `<button onclick="answer(${i})">${a.text}</button>`).join("")}
          </div>
        </div>`;
      resultEl.style.display = "none";
      // move focus to the question header to prevent same-spot buttons appearing "selected"
      setTimeout(() => {
        const h = quizEl.querySelector(".question h3");
        if (h) { h.setAttribute("tabindex","-1"); try { h.focus({preventScroll:true}); } catch(_) {} }
      }, 0);
      updateProgress();
    }

    function applyScores(ansObj, sign){
      for (const [album, pts] of Object.entries(ansObj.scores)) {
        const key = mapAlbumKey(album);
        if (!scores.hasOwnProperty(key)) scores[key] = 0;
        scores[key] += sign * pts;
      }
    }

    function answer(ev, i) {
      const q = questions[currentQ];
      const ans = q.answers[i];
      // blur tapped element to avoid sticky focus on mobile
      try {
        if (ev && ev.currentTarget && typeof ev.currentTarget.blur === "function") {
          ev.currentTarget.blur();
        }
      } catch(_) {}
      try {
        if (document.activeElement && typeof document.activeElement.blur === "function") {
          document.activeElement.blur();
        }
      } catch(_) {}
      // apply scores positively
      applyScores(ans, +1);
      // record history
      answerHistory[currentQ] = i;
      currentQ++;
      if (currentQ >= questions.length) { showResult(); }
      else { renderQuestion(); }
    }

    function goBackOneStep(){
      // If on first question, do nothing
      if (currentQ === 0) return;
      // If we're at result screen, step back to last question
      if (currentQ >= questions.length) {
        currentQ = questions.length - 1;
      } else {
        // stepping back from an in-progress question means we previously answered currentQ-1
        currentQ = currentQ - 1;
      }
      // Undo the scores of the answer we had selected for that question (if any)
      const prevIndex = answerHistory[currentQ];
      if (typeof prevIndex === "number") {
        const prevAns = questions[currentQ].answers[prevIndex];
        applyScores(prevAns, -1);
        // Optional: clear the stored answer so back-back doesn't keep subtracting
        // but we prefer to keep it so the user can go forward again without losing state.
      }
      renderQuestion();
    }

    // Attach BACK behavior (only within quiz)
    backBtn.addEventListener("click", goBackOneStep);
    // Optional keyboard shortcut: Shift+B
    window.addEventListener("keydown", (e) => {
      if ((e.key === "B" || e.key === "b") && e.shiftKey) goBackOneStep();
    });

    function showResult() {
      quizEl.innerHTML = "";
      try { if (document.activeElement && document.activeElement.blur) document.activeElement.blur(); } catch(_) {}
      const topAlbum = Object.entries(scores).sort((a,b)=>b[1]-a[1])[0][0];
      const emoji = albumEmojis[topAlbum] || "ðŸŽ¶";
      resultEl.style.display = "block";
      resultEl.innerHTML = `
        <h2>Your Taylor Swift Era is:</h2>
        <h1>${topAlbum}</h1>
        <div style="font-size:3em; margin-top:10px;">${emoji}</div>
      `;
      updateProgress();
    }

    // Initial render
    renderQuestion();
  </script>
</body>
</html>
